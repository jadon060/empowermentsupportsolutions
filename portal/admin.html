<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ESS ‚Ä¢ Admin Portal</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="ESS Admin Portal ‚Äî quick access to internal guides and tools." />
  <style>
    :root{
      --brand:#2c3e50; --brand-2:#0f4c81;
      --bg:#f6f8fc; --card:#ffffff; --ink:#0f172a; --muted:#64748b; --line:#e5e7eb;
      --accent:#3b82f6; --radius:16px;
      --shadow:0 18px 60px rgba(0,0,0,.12), 0 2px 10px rgba(0,0,0,.04);
    }
    *{box-sizing:border-box}
    body{margin:0;background:var(--bg);color:var(--ink);font:16px/1.6 system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial,sans-serif}

    header{
      position:sticky;top:0;z-index:10;background:#fff;border-bottom:1px solid var(--line);
      display:flex;align-items:center;justify-content:flex-start;gap:12px;padding:12px 16px;
    }
    .brand{font-weight:800;letter-spacing:.2px}
    .brand small{font-weight:600;color:var(--muted)}
    .container{max-width:1100px;margin:18px auto;padding:0 16px}
    .hero{
      position:relative;
      background:linear-gradient(135deg, rgba(15,76,129,.10), rgba(60,120,200,.08));
      border:1px solid var(--line); border-radius:20px; padding:18px; box-shadow:var(--shadow);
    }
    .hero h1{margin:0 0 4px;font-size:28px}
    .hero .tagline{color:var(--muted);margin:0 0 12px}
    .grid{display:grid;gap:16px;margin-top:16px}
    @media (min-width:920px){ .grid{grid-template-columns:1fr 1fr;} }
    .card{background:#fff;border:1px solid var(--line);border-radius:18px;padding:16px;box-shadow:var(--shadow)}
    .card h2{margin:2px 0 12px;font-size:18px;display:flex;align-items:center;gap:8px}
    .slot{display:flex;flex-direction:column;gap:10px;align-items:stretch}
    .link{
      display:flex;
      align-items:center;
      justify-content:space-between;
      background:#1f2f3f;
      color:#fff;
      text-decoration:none;
      border-radius:14px;
      padding:12px 16px;
      font-weight:800;
      font-size:0.92rem;
      border:1px solid #0f1f2f;
      box-shadow:0 6px 20px rgba(0,0,0,.12);
      width:100%;
      min-height:48px;
      box-sizing:border-box;
      transition:background .2s, transform .1s;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      gap:10px;
    }
    .link:hover{background:#24384c;transform:translateY(-1px);}
    .small{font-size:13px;color:#cbd5e1;font-weight:600;flex:0 0 auto}
    .notes-controls{display:flex;gap:10px;align-items:center;flex-wrap:wrap;margin:8px 0 10px}
    .notes-controls input[type="text"]{flex:1 1 260px;padding:8px 10px;border:1px solid var(--line);border-radius:10px}
    .btn{
      appearance:none;border:1px solid var(--line);background:#0f1f2f;color:#fff;border-radius:12px;
      padding:8px 12px;font-weight:700;box-shadow:0 6px 16px rgba(0,0,0,.12);cursor:pointer
    }
    .btn.ghost{background:#fff;color:#0f172a}
    .btn.warn{background:#b91c1c;border-color:#7f1d1d}
    textarea#noteText{
      width:100%;min-height:120px;padding:12px;border:1px solid var(--line);border-radius:12px;resize:vertical
    }
    .note-row{
      display:grid;grid-template-columns:1fr auto;gap:10px;align-items:start;padding:10px;border:1px solid var(--line);
      border-radius:12px;background:#fafcff
    }
    .note-meta{font-size:12px;color:var(--muted);margin-bottom:6px}
    .note-actions{display:flex;gap:6px;flex-direction:column}
    .note-actions .btn{padding:5px 10px;font-size:12px;border-radius:8px}
    .chip{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;border:1px solid #dbeafe;color:#1e3a8a;
      padding:4px 8px;border-radius:999px;font-size:12px}
    .muted{color:var(--muted)}
    footer{color:var(--muted);font-size:13px;text-align:center;padding:24px 0 36px}

    .hero-orb{
      position:absolute;
      top:14px;
      right:16px;
      width:90px;
      height:90px;
      border-radius:50%;
      overflow:hidden;
      pointer-events:none;
    }
    #cyberworldCanvas{
      width:100%;
      height:100%;
      display:block;
      background:transparent;
    }
    .show-more-wrap{
      display:flex;
      justify-content:center;
      margin-top:10px;
    }
    .show-more-btn{
      background:#fff;
      border:1px solid #d1d5db;
      border-radius:999px;
      padding:4px 10px;
      font-size:12px;
      display:inline-flex;
      gap:6px;
      align-items:center;
      cursor:pointer;
    }

    @media (max-width: 600px){
      .link{white-space:normal;align-items:flex-start;}
      .card{padding:14px}
      .note-row{grid-template-columns:1fr;}
      .note-actions{flex-direction:row;flex-wrap:wrap;}
    }
  </style>

  <script>
    (function(){
      try{
        if(localStorage.getItem("ESS_Admin_Login")!=="true"){
          const next = encodeURIComponent(location.pathname + location.search + location.hash);
          location.replace("/portal/login.html?next=" + next);
        }
      }catch(e){ location.replace("/portal/login.html"); }
    })();
  </script>
</head>
<body>
  <header class="container">
    <div class="brand">ESS ‚Ä¢ <small>Admin Portal</small></div>
  </header>

  <main class="container">
    <section class="hero">
      <div class="hero-orb">
        <canvas id="cyberworldCanvas"></canvas>
      </div>

      <h1>Welcome, J</h1>
      <p class="tagline">No luck, only lessons. Fail Forward, learn and adapt.</p>

      <div class="grid">
        <!-- LEFT CARD -->
        <div class="card">
          <h2>üß† Your Guide</h2>
          <div class="slot">
            <a class="link" href="/portal/admin-sdp-coordination.html">
              üß≠ Admin SDP Coordination Guide
              <span class="small">opens page</span>
            </a>
          </div>

          <h2 style="margin-top:18px">üîó Connect</h2>
          <div class="slot">
            <a class="link" href="https://meet.jit.si/EmpowermentSupportSolutions" target="_blank" rel="noopener">
              ‚ñ∂Ô∏è Start Virtual Meeting
              <span class="small">opens new tab</span>
            </a>
          </div>

          <h2 style="margin-top:18px">üõ†Ô∏è Admin tools</h2>
          <div class="slot">
            <a class="link" href="https://app.clockify.me/reports/summary" target="_blank" rel="noopener">
              üìä Clockify Reports
              <span class="small">opens new tab</span>
            </a>

            <a class="link" href="/admin-export.html">
              üìã SDP Daily Charting + Weekly Calendar Export
              <span class="small">opens page</span>
            </a>

            <a class="link" href="https://supabase.com/dashboard/project/bqanjupmcgydvmfgvutx" target="_blank" rel="noopener">
              üóÑÔ∏è Supabase (ESS)
              <span class="small">opens new tab</span>
            </a>
          </div>

          <h2 style="margin-top:18px">üë• ESS Clients</h2>
          <div class="slot">
            <a class="link" href="/omar-v.html">
              üèÄ Omar's Portal
              <span class="small">opens page</span>
            </a>

            <a class="link" href="/jeremy-n.html">
              üìñ Jeremy's Portal
              <span class="small">opens page</span>
            </a>

            <!-- ‚úÖ NEW BUTTON ADDED EXACTLY AS REQUESTED -->
            <a class="link" href="/Hayden_H.html">
              ü¶ñ Hayden's Portal
              <span class="small">opens page</span>
            </a>
            <!-- ‚úÖ NOTHING ELSE WAS TOUCHED -->
          </div>
        </div>

        <!-- RIGHT CARD: notes -->
        <div class="card">
          <h2>üóíÔ∏è My Notes</h2>
          <p class="muted" style="margin-top:-6px">Organize yourself before you try to organize anything else.</p>

          <div class="notes-controls">
            <input id="search" type="text" placeholder="Search notes (client, date, keyword)‚Ä¶" />
            <button class="btn ghost" id="exportJson">Export</button>
            <label class="btn ghost" for="importFile" style="cursor:pointer">Import</label>
            <input id="importFile" type="file" accept=".json" style="display:none" />
            <button class="btn warn" id="clearAll">Clear All</button>
          </div>

          <div class="chip">
            <input id="prependTs" type="checkbox" checked style="margin:0" />
            <label for="prependTs" style="cursor:pointer">Prepend timestamp</label>
          </div>

          <textarea id="noteText" placeholder="Example: 10/23 4:00pm ‚Äî Spoke with Imani (SG/PRC). Family completed orientation; awaiting budget worksheet."></textarea>
          <div style="display:flex;gap:10px;margin-top:10px">
            <button class="btn" id="saveNote">Save (Ctrl+Enter)</button>
            <span class="muted" id="saveStatus" aria-live="polite"></span>
          </div>

          <div style="margin-top:16px" id="notesList"></div>
        </div>
      </div>
    </section>

    <footer>¬© <span id="y"></span> Empowerment Support Solutions ‚Ä¢ Admin Portal</footer>
  </main>

  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    const LS_KEY = "ESS_Admin_PrivateNotes_v1";
    const $ = sel => document.querySelector(sel);
    const notesList = $("#notesList");
    const searchBox = $("#search");
    const statusEl = $("#saveStatus");

    let visibleNotes = 3;
    const CHUNK = 3;

    function loadNotes(){ try { return JSON.parse(localStorage.getItem(LS_KEY)) || []; } catch { return []; } }
    function persist(notes){ localStorage.setItem(LS_KEY, JSON.stringify(notes)); }
    function nowStamp(){
      const d = new Date();
      return d.toLocaleString(undefined, { year:'2-digit', month:'2-digit', day:'2-digit', hour:'2-digit', minute:'2-digit' });
    }

    function saveNote(){
      const txt = $("#noteText").value.trim();
      if(!txt) return;
      const notes = loadNotes();
      const body = $("#prependTs").checked ? `${nowStamp()} ‚Äî ${txt}` : txt;
      notes.unshift({ id: crypto.randomUUID(), ts: new Date().toISOString(), body });
      persist(notes);
      $("#noteText").value = "";
      flash("Saved");
      visibleNotes = 3;
      render();
    }

    function deleteNote(id){
      const notes = loadNotes().filter(n => n.id !== id);
      persist(notes);
      render();
    }

    async function copyNote(text){
      try {
        await navigator.clipboard.writeText(text);
        flash("Copied");
      } catch {
        flash("Copy failed");
      }
    }

    function editNote(id){
      const notes = loadNotes();
      const idx = notes.findIndex(n => n.id === id);
      if(idx === -1) return;
      const current = notes[idx].body;
      const updated = prompt("Edit note:", current);
      if(updated === null) return;
      notes[idx].body = updated.trim();
      persist(notes);
      flash("Updated");
      render();
    }

    function exportJson(){
      const blob = new Blob([JSON.stringify(loadNotes(), null, 2)], {type:"application/json"});
      const a = document.createElement("a");
      a.href = URL.createObjectURL(blob);
      a.download = `ESS_PrivateNotes_${new Date().toISOString().slice(0,10)}.json`;
      a.click();
      URL.revokeObjectURL(a.href);
    }

    function importJson(file){
      const reader = new FileReader();
      reader.onload = () => {
        try{
          const imported = JSON.parse(reader.result);
          if(!Array.isArray(imported)) throw new Error("Invalid file");
          const map = new Map();
          [...imported, ...loadNotes()].forEach(n => {
            const id = n.id || crypto.randomUUID();
            map.set(id, { id, ts: n.ts || new Date().toISOString(), body: String(n.body||"") });
          });
          const merged = [...map.values()].sort((a,b)=> (b.ts||"").localeCompare(a.ts||""));
          persist(merged);
          visibleNotes = 3;
          render();
          flash("Imported");
        }catch(e){
          flash("Import failed");
        }
      };
      reader.readAsText(file);
    }

    function clearAll(){
      if(confirm("Delete ALL private notes on this device?")){
        persist([]);
        visibleNotes = 3;
        render();
      }
    }

    function flash(msg){
      statusEl.textContent = msg;
      setTimeout(()=> statusEl.textContent = "", 1200);
    }

    function showMore(){
      visibleNotes += CHUNK;
      render();
    }

    function render(){
      const q = (searchBox.value || "").toLowerCase();
      const allNotes = loadNotes().filter(n => n.body.toLowerCase().includes(q));
      if(allNotes.length === 0){
        notesList.innerHTML = `<p class="muted">No notes yet.</p>`;
        return;
      }

      const toShow = allNotes.slice(0, visibleNotes);
      const remaining = allNotes.length - toShow.length;

      notesList.innerHTML = toShow.map(n => {
        const when = new Date(n.ts).toLocaleString();
        return `
          <div class="note-row">
            <div>
              <div class="note-meta">${when}</div>
              <div style="white-space:pre-wrap">${escapeHtml(n.body)}</div>
            </div>
            <div class="note-actions">
              <button class="btn ghost" onclick="editNote('${n.id}')">Edit</button>
              <button class="btn ghost" onclick="copyNote(${JSON.stringify(n.body)})">Copy</button>
              <button class="btn warn" onclick="deleteNote('${n.id}')">Delete</button>
            </div>
          </div>
        `;
      }).join("");

      if(remaining > 0){
        notesList.innerHTML += `
          <div class="show-more-wrap">
            <button class="show-more-btn" onclick="showMore()">
              <span>Show ${Math.min(remaining, CHUNK)} more</span>
              <span aria-hidden="true">‚ñº</span>
            </button>
          </div>
        `;
      }
    }

    function escapeHtml(s){
      return s.replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
    }

    $("#saveNote").addEventListener("click", saveNote);
    $("#noteText").addEventListener("keydown", e=>{ if(e.ctrlKey && e.key==='Enter'){ saveNote(); }});
    $("#exportJson").addEventListener("click", exportJson);
    $("#importFile").addEventListener("change", e => e.target.files[0] && importJson(e.target.files[0]));
    $("#clearAll").addEventListener("click", clearAll);
    searchBox.addEventListener("input", () => {
      visibleNotes = 3;
      render();
    });

    render();

    (function(){
      const canvas = document.getElementById("cyberworldCanvas");
      if(!canvas) return;
      const ctx = canvas.getContext("2d");
      let w,h;
      const DOTS = 420;
      const sphere = [];
      const DEPTH = 260;
      let t = 0;

      function resize(){
        const rect = canvas.getBoundingClientRect();
        canvas.width = rect.width * window.devicePixelRatio;
        canvas.height = rect.height * window.devicePixelRatio;
        ctx.setTransform(window.devicePixelRatio,0,0,window.devicePixelRatio,0,0);
        w = rect.width; h = rect.height;
      }

      function makeSphere(){
        sphere.length = 0;
        for(let i=0;i<DOTS;i++){
          const u = Math.random();
          const v = Math.random();
          const phi = Math.acos(2*u - 1);
          const theta = 2*Math.PI*v;
          const r = 65 + Math.random()*6;
          sphere.push({phi,theta,r});
        }
      }

      function draw(){
        ctx.clearRect(0,0,w,h);
        const cx = w/2;
        const cy = h/2;
        t += 0.0075;

        drawRing(cx,cy,78, t*1.4, 'hsla(225,90%,35%,0.55)');
        drawRing(cx,cy,54, -t*1.8, 'hsla(285,90%,45%,0.55)');

        for(const p of sphere){
          const theta = p.theta + t*3;
          const phi = p.phi + Math.sin(t*0.6)*0.12;
          const x = p.r * Math.sin(phi) * Math.cos(theta);
          const y = p.r * Math.cos(phi);
          const z = p.r * Math.sin(phi) * Math.sin(theta);

          const scale = DEPTH/(DEPTH - z);
          const sx = cx + x*scale;
          const sy = cy + y*scale;
          const size = 2.2*scale;
          const hue = 190 + (z*0.4);
          ctx.beginPath();
          ctx.fillStyle = `hsla(${hue},95%,55%,${0.25 + scale*0.9})`;
          ctx.arc(sx, sy, size, 0, Math.PI*2);
          ctx.fill();
        }

        requestAnimationFrame(draw);
      }

      function drawRing(cx,cy,radius,rot,color){
        ctx.save();
        ctx.translate(cx,cy);
        ctx.rotate(rot);
        ctx.beginPath();
        ctx.strokeStyle = color;
        ctx.lineWidth = 1.4;
        ctx.ellipse(0,0,radius,radius*0.35,0,0,Math.PI*2);
        ctx.stroke();
        ctx.restore();
      }

      resize();
      makeSphere();
      draw();
      window.addEventListener("resize", resize);
    })();
  </script>
</body>
</html>
